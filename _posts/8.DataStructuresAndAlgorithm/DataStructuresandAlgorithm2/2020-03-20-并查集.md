---
layout: post
title: "ã€è¿›é˜¶ã€‘6ã€å¹¶æŸ¥é›†"
date: 2020-03-20
description: ""
tag: æ•°æ®ç»“æ„ä¸ç®—æ³•
---






## ç›®å½•

* [å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰](#content1)
* [å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰å®ç°](#content2)
* [å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰ä¼˜åŒ–](#content3)
* [æ€»ç»“](#content4)
* [å…³äºè‡ªå®šä¹‰ç±»å‹](#content5)








<!-- ************************************************ -->
## <a id="content1"></a>å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰

**ä¸€ã€éœ€æ±‚åˆ†æ**

å‡è®¾æœ‰nä¸ªæ‘åº„ï¼Œæœ‰äº›æ‘åº„ä¹‹é—´æœ‰è¿æ¥çš„è·¯ï¼Œæœ‰äº›æ‘åº„ä¹‹é—´å¹¶æ²¡æœ‰è¿æ¥çš„è·¯

<img src="/images/DataStructurs2/union1.png" alt="img">


è®¾è®¡ä¸€ä¸ªæ•°æ®ç»“æ„ï¼Œèƒ½å¤Ÿå¿«é€Ÿæ‰§è¡Œ2ä¸ªæ“ä½œ      
ï°æŸ¥è¯¢2ä¸ªæ‘åº„ä¹‹é—´æ˜¯å¦æœ‰è¿æ¥çš„è·¯      
ï°è¿æ¥2ä¸ªæ‘åº„        


æ•°ç»„ã€é“¾è¡¨ã€å¹³è¡¡äºŒå‰æ ‘ã€é›†åˆï¼ˆSetï¼‰ï¼Ÿ  
æŸ¥è¯¢ã€è¿æ¥çš„æ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ï¼šO(n)     

å¹¶æŸ¥é›†èƒ½å¤ŸåŠåˆ°æŸ¥è¯¢ã€è¿æ¥çš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯ O(Î±(n)) ï¼ŒÎ±(n) < 5     
å¹¶æŸ¥é›†éå¸¸é€‚åˆè§£å†³è¿™ç±»â€œè¿æ¥â€ç›¸å…³çš„é—®é¢˜      



**äºŒã€å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰ä»‹ç»**

å¹¶æŸ¥é›†ä¹Ÿå«ä½œä¸ç›¸äº¤é›†åˆï¼ˆDisjoint Setï¼‰

å¹¶æŸ¥é›†æœ‰2ä¸ªæ ¸å¿ƒæ“ä½œ    
ï°æŸ¥æ‰¾ï¼ˆFindï¼‰ï¼šæŸ¥æ‰¾å…ƒç´ æ‰€åœ¨çš„é›†åˆï¼ˆè¿™é‡Œçš„é›†åˆå¹¶ä¸æ˜¯ç‰¹æŒ‡Setè¿™ç§æ•°æ®ç»“æ„ï¼Œæ˜¯æŒ‡å¹¿ä¹‰çš„æ•°æ®é›†åˆï¼‰    
ï°åˆå¹¶ï¼ˆUnionï¼‰ï¼šå°†ä¸¤ä¸ªå…ƒç´ æ‰€åœ¨çš„é›†åˆåˆå¹¶ä¸ºä¸€ä¸ªé›†åˆ    

æœ‰2ç§å¸¸è§çš„å®ç°æ€è·¯     

1ã€Quick Find    
âœ“ æŸ¥æ‰¾ï¼ˆFindï¼‰ çš„æ—¶é—´å¤æ‚åº¦ï¼šO(1)     
âœ“ åˆå¹¶ï¼ˆUnionï¼‰çš„æ—¶é—´å¤æ‚åº¦ï¼šO(n)     

2ã€Quick Union      
âœ“ æŸ¥æ‰¾ï¼ˆFindï¼‰ çš„æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå¯ä»¥ä¼˜åŒ–è‡³ O(Î±(n)) ï¼ŒÎ±(n) < 5    
âœ“ åˆå¹¶ï¼ˆUnionï¼‰çš„æ—¶é—´å¤æ‚åº¦ï¼šO(logn)ï¼Œå¯ä»¥ä¼˜åŒ–è‡³ O(Î±(n)) ï¼ŒÎ±(n) < 5    
 

**ä¸‰ã€å¦‚ä½•å­˜å‚¨æ•°æ®**

å‡è®¾å¹¶æŸ¥é›†å¤„ç†çš„æ•°æ®éƒ½æ˜¯æ•´å‹ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨æ•´å‹æ•°ç»„æ¥å­˜å‚¨æ•°æ®

<img src="/images/DataStructurs2/union2.png" alt="img">

ä¸éš¾çœ‹å‡º     
0ã€1ã€3 å±äºåŒä¸€é›†åˆ     
2 å•ç‹¬å±äºä¸€ä¸ªé›†åˆ    
4ã€5ã€6ã€7 å±äºåŒä¸€é›†åˆ    

å› æ­¤ï¼Œå¹¶æŸ¥é›†æ˜¯å¯ä»¥ç”¨æ•°ç»„å®ç°çš„æ ‘å½¢ç»“æ„ï¼ˆäºŒå‰å †ã€ä¼˜å…ˆçº§é˜Ÿåˆ—ä¹Ÿæ˜¯å¯ä»¥ç”¨æ•°ç»„å®ç°çš„æ ‘å½¢ç»“æ„ï¼‰




<!-- ************************************************ -->
## <a id="content2"></a>å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰å®ç°


**ä¸€ã€æ¥å£å®šä¹‰**

```
/// æ£€æŸ¥v1ã€v2æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(BOOL)isSameWithV1:(int)v1 v2:(int)v2;


/// æŸ¥æ‰¾væ‰€å±çš„é›†åˆï¼Œè¿”å›æ ¹èŠ‚ç‚¹
/// @param v å…ƒç´ v
-(int)findV:(int)v;


/// åˆå¹¶v1ã€v2æ‰€å±çš„é›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(void)unionWithV1:(int)v1 v2:(int)v2;
```


**äºŒã€åˆå§‹åŒ–**

åˆå§‹åŒ–æ—¶ï¼Œæ¯ä¸ªå…ƒç´ å„è‡ªå±äºä¸€ä¸ªå•å…ƒç´ é›†åˆ

<img src="/images/DataStructurs2/union3.png" alt="img">

```
/// åˆå§‹åŒ–ä¸€ä¸ªå¹¶æŸ¥é›†
/// @param capacity å®¹é‡
-(instancetype)initWithCapacity:(int)capacity{
    
    self = [super init];
    if (self) {
        self.parents = [NSMutableArray arrayWithCapacity:capacity];
        for (int i = 0; i<capacity; i++) {
            self.parents[i] = @(i);
        }
    }
    return self;
}
```

**ä¸‰ã€Quick Find**

1ã€Quick Find - union

Quick Find çš„ union(v1, v2)ï¼šè®© v1 æ‰€åœ¨é›†åˆçš„æ‰€æœ‰å…ƒç´ éƒ½æŒ‡å‘ v2 çš„æ ¹èŠ‚ç‚¹

<img src="/images/DataStructurs2/union4.png" alt="img">

<img src="/images/DataStructurs2/union5.png" alt="img">

2ã€Quick Find - Find

<img src="/images/DataStructurs2/union6.png" alt="img">

â—¼ find(0) == 2   
â—¼ find(1) == 2   
â—¼ find(3) == 4   
â—¼ find(2) == 2    

3ã€ä»£ç å®ç°

```
/// æ£€æŸ¥v1ã€v2æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(BOOL)isSameWithV1:(int)v1 v2:(int)v2{
    return [self findV:v1] == [self findV:v2];
}

//æ—¶é—´å¤æ‚åº¦ï¼šO(1)
-(int)findV:(int)v{
    [self rangeCheck:v];
    
    /**
    * çˆ¶èŠ‚ç‚¹å°±æ˜¯æ ¹èŠ‚ç‚¹
    */
    return [self.parents[v] intValue];
}


//æ—¶é—´å¤æ‚åº¦ï¼šO(n)
-(void)unionWithV1:(int)v1 v2:(int)v2{
    int p1 = [self findV:v1];
    int p2 = [self findV:v2];
    if(p1 == p2) return;
    
    /**
    * å°†v1æ‰€åœ¨é›†åˆçš„æ‰€æœ‰å…ƒç´ ï¼Œéƒ½å«æ¥åˆ°v2çš„çˆ¶èŠ‚ç‚¹ä¸Š
    */
    for (int i = 0; i<self.parents.count; i++) {
        if (p1 == [self.parents[i] intValue]) {
            self.parents[i] = @(p2);
        }
    }
}
```


**å››ã€Quick Union**

1ã€Quick Union - union

Quick Union çš„ union(v1, v2)ï¼šè®© v1 çš„æ ¹èŠ‚ç‚¹æŒ‡å‘ v2 çš„æ ¹èŠ‚ç‚¹

<img src="/images/DataStructurs2/union7.png" alt="img">

<img src="/images/DataStructurs2/union8.png" alt="img">


2ã€Quick Union - find

<img src="/images/DataStructurs2/union9.png" alt="img">

â—¼ find(0) == 2    
â—¼ find(1) == 2     
â—¼ find(3) == 2     
â—¼ find(2) == 2    

3ã€ä»£ç å®ç°

```
/**
 * é€šè¿‡parenté“¾æ¡ä¸æ–­åœ°å‘ä¸Šæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°æ ¹èŠ‚ç‚¹
 * æ—¶é—´å¤æ‚åº¦ï¼šO(logn)

 */
-(int)findV:(int)v{
    [self rangeCheck:v];
    while (v != [self.parents[v] intValue]) {
        v = [self.parents[v] intValue];
    }
    return v;
}



/**
 * å°†v1çš„æ ¹èŠ‚ç‚¹å«æ¥åˆ°v2çš„æ ¹èŠ‚ç‚¹ä¸Š
 * æ—¶é—´å¤æ‚åº¦ï¼šO(logn)
 */
-(void)unionWithV1:(int)v1 v2:(int)v2{
    int p1 = [self findV:v1];
    int p2 = [self findV:v2];
    if(p1 == p2) return;
    self.parents[p1] = @(p2);
}
```

<!-- ************************************************ -->
## <a id="content3"></a>å¹¶æŸ¥é›†ï¼ˆUnion Findï¼‰ä¼˜åŒ–

åœ¨Unionçš„è¿‡ç¨‹ä¸­ï¼Œå¯èƒ½ä¼šå‡ºç°æ ‘ä¸å¹³è¡¡çš„æƒ…å†µï¼Œç”šè‡³é€€åŒ–æˆé“¾è¡¨

<img src="/images/DataStructurs2/union10.png" alt="img">

æœ‰2ç§å¸¸è§çš„ä¼˜åŒ–æ–¹æ¡ˆ    
ï°åŸºäºsizeçš„ä¼˜åŒ–ï¼šå…ƒç´ å°‘çš„æ ‘ å«æ¥åˆ° å…ƒç´ å¤šçš„æ ‘    
ï°åŸºäºrankçš„ä¼˜åŒ–ï¼šçŸ®çš„æ ‘ å«æ¥åˆ° é«˜çš„æ ‘      

**ä¸€ã€QuickUnion_Sizeä¼˜åŒ–**

<img src="/images/DataStructurs2/union11.png" alt="img">

```
-(instancetype)initWithCapacity:(int)capacity{
    self = [super initWithCapacity:capacity];
    if (self) {
        //å­˜æ”¾æ ¹èŠ‚ç‚¹å¯¹åº”é›†åˆçš„å…ƒç´ æ•°é‡
        self.sizes = [NSMutableArray arrayWithCapacity:capacity];
        for (int i= 0; i<capacity; i++) {
            //åˆå§‹åŒ–æ—¶æ•°é‡ä¸º1
            self.sizes[i] = @(1);
        }
    }
    return self;
}

-(int)findV:(int)v{
    [self rangeCheck:v];
    while (v != [self.parents[v] intValue]) {
        v = [self.parents[v] intValue];
    }
    return v;
}



//åŸºäºsizeçš„ä¼˜åŒ–ï¼šæ•°é‡æ¯”è¾ƒå°‘çš„å«æ¥åˆ°æ•°é‡æ¯”è¾ƒå¤šçš„ å°½é‡ä¿æŒæ ‘çš„å¹³è¡¡
-(void)unionWithV1:(int)v1 v2:(int)v2{
    int p1 = [self findV:v1];
    int p2 = [self findV:v2];
    if (p1 == p2) return;
    
    
    //æ•°é‡æ¯”è¾ƒå°‘çš„å«æ¥åˆ°æ•°é‡æ¯”è¾ƒå¤šçš„ å°½é‡ä¿æŒæ ‘çš„å¹³è¡¡
    int p1Size = [self.sizes[p1] intValue];
    int p2Size = [self.sizes[p2] intValue];
    if (p1Size < p2Size) {
        //p1 åˆå¹¶åˆ° p2
        self.parents[p1] = @(p2);
        
        //æ›´æ–°p2èŠ‚ç‚¹æ‰€åœ¨é›†åˆçš„å…ƒç´ æ•°é‡
        self.sizes[p2] = @(p1Size + p2Size);
    }else{
        //p2 åˆå¹¶åˆ° p1
        self.parents[p2] = @(p1);
        
        //æ›´æ–°p1èŠ‚ç‚¹æ‰€åœ¨é›†åˆçš„å…ƒç´ æ•°é‡
        self.sizes[p1] = @(p1Size + p2Size);
    }
}
```


**äºŒã€QuickUnion_Rankä¼˜åŒ–**

åŸºäºsizeçš„ä¼˜åŒ–ï¼Œä¹Ÿå¯èƒ½ä¼šå­˜åœ¨æ ‘ä¸å¹³è¡¡çš„é—®é¢˜

<img src="/images/DataStructurs2/union12.png" alt="img">

åŸºäºrankçš„ä¼˜åŒ–

<img src="/images/DataStructurs2/union13.png" alt="img">

```
-(instancetype)initWithCapacity:(int)capacity{
    self = [super initWithCapacity:capacity];
    if (self) {
        //å­˜æ”¾æ ¹èŠ‚ç‚¹å¯¹åº”ç»“åˆçš„æ ‘çš„é«˜åº¦
        self.ranks = [NSMutableArray arrayWithCapacity:capacity];
        for (int i = 0; i<capacity; i++) {
            //åˆå§‹åŒ–æ—¶é«˜åº¦ä¸º1
            self.ranks[i] = @(1);
        }
    }
    return self;
}

-(int)findV:(int)v{
    [self rangeCheck:v];
    while (v != [self.parents[v] intValue]) {
        v = [self.parents[v] intValue];
    }
    return v;
}


//åŸºäºrankçš„ä¼˜åŒ–ï¼šé«˜åº¦æ¯”è¾ƒå°‘çš„å«æ¥åˆ°é«˜åº¦æ¯”è¾ƒå¤šçš„ ä¿æŒæ ‘çš„å¹³è¡¡
-(void)unionWithV1:(int)v1 v2:(int)v2{
    int p1 = [self findV:v1];
    int p2 = [self findV:v2];
    if (p1 == p2) return;
    
    int p1Rank = [self.ranks[p1] intValue];
    int p2Rank = [self.ranks[p2] intValue];
    
    if (p1Rank < p2Rank) {
        self.parents[p1] = @(p2);
        //ä¸éœ€è¦æ›´æ–°æ ‘çš„é«˜åº¦
    }else if(p2Rank < p1Rank){
        self.parents[p2] =@(p1);
        //ä¸éœ€è¦æ›´æ–°æ ‘çš„é«˜åº¦
    }else{
        //ç›¸ç­‰æ—¶ï¼Œè°åˆå¹¶è°éƒ½å¯ä»¥ï¼Œé‡‡ç”¨v1 åˆå¹¶åˆ° v2
        self.parents[p1] = @(p2);
        
        //æ›´æ–°p2Rankçš„é«˜åº¦
        self.ranks[p2] = @(p2Rank+1);
    }
}

```


**ä¸‰ã€QuickUnion_Rank_PathCompressionä¼˜åŒ–**

<img src="/images/DataStructurs2/union14.png" alt="img">

```
//åŸºäº QuickUnion_Rank_PathCompression(è·¯å¾„å‹ç¼©) çš„ä¼˜åŒ–
-(int)findV:(int)v{
    [self rangeCheck:v];
    
    
    int parent =  [self.parents[v] intValue];
    if (v != parent) {
        /**
         ä¼šä¸€è·¯æ‰¾åˆ°æ ¹èŠ‚ç‚¹ï¼Œå¹¶å°†æ²¿é€”èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹éƒ½èµ‹å€¼ä¸ºæ ¹èŠ‚ç‚¹
         
         æ¯”å¦‚ï¼š1->4->8->10
         
         find:4
         1->4->10
            8->10
         
         find:1
         1->10
         4->10
         8->10
         
         
         å­˜åœ¨çš„é—®é¢˜ï¼šæœ‰ä¸€å®šçš„æ€§èƒ½å¼€é”€
         */
        self.parents[v] = @([self findV:parent]);
    }
    return [self.parents[v] intValue];
}
```

è·¯å¾„å‹ç¼©ä½¿è·¯å¾„ä¸Šçš„æ‰€æœ‰èŠ‚ç‚¹éƒ½æŒ‡å‘æ ¹èŠ‚ç‚¹ï¼Œæ‰€ä»¥å®ç°æˆæœ¬ç¨é«˜

è¿˜æœ‰2ç§æ›´ä¼˜çš„åšæ³•ï¼Œä¸ä½†èƒ½é™ä½æ ‘é«˜ï¼Œå®ç°æˆæœ¬ä¹Ÿæ¯”è·¯å¾„å‹ç¼©ä½    
è·¯å¾„åˆ†è£‚ï¼ˆPath Splitingï¼‰     
è·¯å¾„å‡åŠï¼ˆPath Halvingï¼‰        
è·¯å¾„åˆ†è£‚ã€è·¯å¾„å‡åŠçš„æ•ˆç‡å·®ä¸å¤šï¼Œä½†éƒ½æ¯”è·¯å¾„å‹ç¼©è¦å¥½         

**å››ã€QuickUnion_Rank_PathSplittingä¼˜åŒ–**

è·¯å¾„åˆ†è£‚ï¼šä½¿è·¯å¾„ä¸Šçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½æŒ‡å‘å…¶ç¥–çˆ¶èŠ‚ç‚¹ï¼ˆparentçš„parentï¼‰

<img src="/images/DataStructurs2/union15.png" alt="img">

```
//åŸºäº QuickUnion_Rank_PathSplitting(è·¯å¾„åˆ†è£‚) çš„ä¼˜åŒ–
-(int)findV:(int)v{
    [self rangeCheck:v];
    
    while (v!= [self.parents[v] intValue]) {
        
        int parent =  [self.parents[v] intValue];
        int grand = [self.parents[parent] intValue];
        
        //å°†vçš„çˆ¶èŠ‚ç‚¹å˜ä¸ºå…¶ç¥–çˆ¶èŠ‚ç‚¹
        self.parents[v] = @(grand);
        
        //ä¸‹è½®æŸ¥çœ‹å…¶çˆ¶èŠ‚ç‚¹
        v = parent;
    }
   
    return v;
}
```

**äº”ã€QuickUnion_Rank_PathHalvingä¼˜åŒ–**

è·¯å¾„å‡åŠï¼šä½¿è·¯å¾„ä¸Šæ¯éš”ä¸€ä¸ªèŠ‚ç‚¹å°±æŒ‡å‘å…¶ç¥–çˆ¶èŠ‚ç‚¹ï¼ˆparentçš„parentï¼‰

<img src="/images/DataStructurs2/union16.png" alt="img">


```
//åŸºäº QuickUnion_Rank_PathHalving(è·¯å¾„å‡åŠ) çš„ä¼˜åŒ–
-(int)findV:(int)v{
    [self rangeCheck:v];
    
    while (v != [self.parents[v] intValue]) {
        int parent =  [self.parents[v] intValue];
        int grand = [self.parents[parent] intValue];
        
        //å°†vçš„çˆ¶èŠ‚ç‚¹å˜ä¸ºå…¶ç¥–çˆ¶èŠ‚ç‚¹
        self.parents[v] = @(grand);
        
        //ä¸‹è½®æŸ¥çœ‹å…¶ç¥–çˆ¶èŠ‚ç‚¹
        v = grand;
    }
   
    return v;
}
```


<!-- ************************************************ -->
## <a id="content4"></a>æ€»ç»“

æ‘˜è‡ªã€Šç»´åŸºç™¾ç§‘ã€‹ï¼š https://en.wikipedia.org/wiki/Disjoint-set_data_structure#Time_complexity

<img src="/images/DataStructurs2/union17.png" alt="img">

å¤§æ¦‚æ„æ€æ˜¯
ä½¿ç”¨è·¯å¾„å‹ç¼©ã€åˆ†è£‚æˆ–å‡åŠ + åŸºäºrankæˆ–è€…sizeçš„ä¼˜åŒ–      
âœ“ å¯ä»¥ç¡®ä¿æ¯ä¸ªæ“ä½œçš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸º O(ğ›¼(ğ‘›)) ï¼ŒÎ±(ğ‘›) < 5        

ä¸ªäººå»ºè®®çš„æ­é…    
âœ“ Quick Union     
âœ“ åŸºäº rank çš„ä¼˜åŒ–     
âœ“ Path Halving æˆ– Path Spliting     



<!-- ************************************************ -->
## <a id="content5"></a>å…³äºè‡ªå®šä¹‰ç±»å‹


ä¹‹å‰çš„ä½¿ç”¨éƒ½æ˜¯åŸºäºæ•´å‹æ•°æ®ï¼Œå¦‚æœå…¶ä»–è‡ªå®šä¹‰ç±»å‹ä¹Ÿæƒ³ä½¿ç”¨å¹¶æŸ¥é›†å‘¢ï¼Ÿ

æ–¹æ¡ˆä¸€ï¼šé€šè¿‡ä¸€äº›æ–¹æ³•å°†è‡ªå®šä¹‰ç±»å‹è½¬ä¸ºæ•´å‹åä½¿ç”¨å¹¶æŸ¥é›†ï¼ˆæ¯”å¦‚ç”Ÿæˆå“ˆå¸Œå€¼ï¼‰    
æ–¹æ¡ˆäºŒï¼šä½¿ç”¨é“¾è¡¨+æ˜ å°„(Map)     

```
@interface LCGenericUnionFind : NSObject

/// è®¾ç½®ä¸€ä¸ªé›†åˆå…ƒç´ 
/// @param v å…ƒç´ 
-(void)makeSet:(id)v;


/// æŸ¥æ‰¾væ‰€å±çš„é›†åˆï¼Œè¿”å›æ ¹èŠ‚ç‚¹
/// @param v å…ƒç´ v
-(id)findV:(id)v;


/// æ£€æŸ¥v1ã€v2æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(BOOL)isSameWithV1:(id)v1 v2:(id)v2;


/// åˆå¹¶v1ã€v2æ‰€å±çš„é›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(void)unionWithV1:(id)v1 v2:(id)v2;

@end
```

```

#import "LCGenericUnionFind.h"



#pragma mark - LCUFNode

@interface LCUFNode : NSObject
@property(nonatomic,strong)id           value;  //value
@property(nonatomic,strong)LCUFNode *   parent; //çˆ¶èŠ‚ç‚¹
@property(nonatomic,assign)int          rank;   //èŠ‚ç‚¹é«˜åº¦
@end;


@implementation LCUFNode

-(instancetype)init{
    if (self = [super init]) {
        self.parent = self;
        self.rank = 1;
    }
    return self;
}


-(instancetype)initWithValue:(id)value{
    if(self = [self init]){
         self.value = value;
    }
    return self;
}
@end



#pragma mark - LCGenericUnionFind

@interface LCGenericUnionFind()
@property(nonatomic,strong)NSMutableDictionary * nodes;
@end


@implementation LCGenericUnionFind

-(NSMutableDictionary *)nodes{
    if (_nodes == nil) {
        _nodes = [NSMutableDictionary dictionary];
    }
    return _nodes;
}

//v:node,æ”¾å…¥nodes
-(void)makeSet:(id)v{
    if ([self __nodesGet:v]) return;
    LCUFNode * node = [[LCUFNode alloc] initWithValue:v];
    [self __nodesPutKey:v value:node];
}



/// æŸ¥æ‰¾væ‰€å±çš„é›†åˆï¼Œè¿”å›æ ¹èŠ‚ç‚¹
/// @param v å…ƒç´ v
-(id)findV:(id)v{
    LCUFNode * rootNode = [self __findRootNodeV:v];
    return rootNode?rootNode.value:nil;
}



/// æ£€æŸ¥v1ã€v2æ˜¯å¦å±äºåŒä¸€ä¸ªé›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(BOOL)isSameWithV1:(id)v1 v2:(id)v2{
    return [[self findV:v1] isEqual:[self findV:v2]];
}




/// åˆå¹¶v1ã€v2æ‰€å±çš„é›†åˆ
/// @param v1 å…ƒç´ v1
/// @param v2 å…ƒç´ v2
-(void)unionWithV1:(id)v1 v2:(id)v2{
    
    LCUFNode* v1Root = [self __findRootNodeV:v1];
    LCUFNode* v2Root = [self __findRootNodeV:v2];
    
    if ([v1Root isEqual:v2Root]) return;
    
    if (v1Root.rank < v2Root.rank) {
        v1Root.parent = v2Root;
    }else if(v2Root.rank < v1Root.rank){
        v2Root.parent = v1Root;
    }else{
        v1Root.parent = v2Root;
        v2Root.rank +=1;
    }
}


                      
#pragma mark - å†…éƒ¨æ–¹æ³•
                      
                      
-(id)__nodesGet:(id)key{
    NSString * keyHash = [NSString stringWithFormat:@"%ld",[key hash]];
    return  [self.nodes objectForKey:keyHash];
}

-(void)__nodesPutKey:(id)key value:(id)value{
    NSString * keyHash = [NSString stringWithFormat:@"%ld",[key hash]];
    [self.nodes setObject:value forKey:keyHash];
}
                

-(LCUFNode*)__findRootNodeV:(id)v{
    
    LCUFNode * node = [self __nodesGet:v];
    if (node == nil) return nil;
    
    while (![node isEqual:node.parent]) {
        node = node.parent;
    }
    
    return node;
}

@end
```

ä½¿ç”¨ç¤ºä¾‹ï¼š
```
-(void)test9_2{
    
    LCGenericUnionFind * unionFind = [[LCGenericUnionFind alloc] init];
    
    NSObject * obj1 = [[NSObject alloc] init];
    NSObject * obj2 = [[NSObject alloc] init];
    NSObject * obj3 = [[NSObject alloc] init];
    NSObject * obj4 = [[NSObject alloc] init];
    
    
    [unionFind makeSet:obj1];
    [unionFind makeSet:obj2];
    [unionFind makeSet:obj3];
    [unionFind makeSet:obj4];
    [unionFind unionWithV1:obj1 v2:obj2];
    [unionFind unionWithV1:obj1 v2:obj3];
    [unionFind unionWithV1:obj1 v2:obj4];
    
    [LCAssert AssertWithValue:[unionFind isSameWithV1:obj2 v2:obj4]];

    
    NSObject * obj5 = [[NSObject alloc] init];
    NSObject * obj6 = [[NSObject alloc] init];
    [unionFind makeSet:obj5];
    [unionFind makeSet:obj6];
    [unionFind unionWithV1:obj5 v2:obj6];
    [LCAssert AssertWithValue:[unionFind isSameWithV1:obj5 v2:obj6]];
    [LCAssert AssertWithValue:![unionFind isSameWithV1:obj3 v2:obj6]];
    [unionFind unionWithV1:obj2 v2:obj6];
    [LCAssert AssertWithValue:[unionFind isSameWithV1:obj1 v2:obj6]];


    
    NSObject * obj7 = [[NSObject alloc] init];
    NSObject * obj8 = [[NSObject alloc] init];
    [unionFind makeSet:obj7];
    [unionFind makeSet:obj8];
    [unionFind unionWithV1:obj7 v2:obj8];
    [LCAssert AssertWithValue:[unionFind isSameWithV1:obj7 v2:obj8]];
    [LCAssert AssertWithValue:![unionFind isSameWithV1:obj1 v2:obj8]];
    [unionFind unionWithV1:obj5 v2:obj8];
    [LCAssert AssertWithValue:[unionFind isSameWithV1:obj1 v2:obj8]];
}
```


----------
>  è¡Œè€…å¸¸è‡³ï¼Œä¸ºè€…å¸¸æˆï¼


